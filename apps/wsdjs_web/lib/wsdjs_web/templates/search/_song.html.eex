<%= if blur_track(@song, @current_user) == true do %>

<li>
  <a>
    <article class="song-minicard">
      <div class="song-minicard__heading">
        <img src="<%= art_url(nil, 200) %>" class="responsive" />
      </div>
      <div class="song-minicard__body">
        <span class="text-muted text-ellipsis">hidden track</span>

        <footer class="song-minicard__footer">
          <span class="label label-default"><%= @song.genre %></span>
          <%= if @song.bpm > 0 do %>
            <span class="label label-primary"><%= @song.bpm %> bpm</span>
          <% end %>
          <time class="timeago" datetime="<%= utc_to_local(@song.inserted_at) %>">
            <%= Timex.format!(@song.inserted_at, "%b %Y", :strftime) %>
          </time>
        </footer>
      </div>
    </article>
  </a>
</li>

<% else %>

<li>
  <a href="<%= song_path(@conn, :show, @song.id) %>">
    <article class="song-minicard">
      <div class="song-minicard__heading">
        <img src="<%= art_url(@song.art, 200) %>" class="responsive" />
      </div>
      <div class="song-minicard__body">
        <span class="text-ellipsis song-title"><%= @song.title %></span>
        <span class="text-ellipsis song-artist">by <%= @song.artist %></span>
        <span class="text-muted text-ellipsis song-suggestor">
          <%= gettext "suggested by" %> <%= user_displayed_name(@song.user) %>
        </span>

        <footer class="song-minicard__footer">
          <span class="label label-default"><%= @song.genre %></span>
          <%= if @song.bpm > 0 do %>
            <span class="label label-primary"><%= @song.bpm %> bpm</span>
          <% end %>
          <time class="timeago" datetime="<%= utc_to_local(@song.inserted_at) %>">
            <%= Timex.format!(@song.inserted_at, "%b %Y", :strftime) %>
          </time>
        </footer>
      </div>
    </article>
  </a>
</li>

<% end %>