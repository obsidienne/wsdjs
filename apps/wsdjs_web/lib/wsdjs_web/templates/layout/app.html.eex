<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable = no">
    <meta http-equiv="Accept-CH" content="DPR, Viewport-Width, Width">
    <meta name="cloudinary_cloud_name" content="don2kwaju">
    <meta name="description" content="World Swing DeeJays. The best West Coast Swing music from all around the world !">

    <!-- Control the behavior of search engine crawling and indexing -->
    <meta name="robots" content="index,follow"><!-- All Search Engines -->
    <meta name="googlebot" content="index,follow"><!-- Google Specific -->
    <!-- Tells Google not to show the sitelinks search box -->
    <meta name="google" content="nositelinkssearchbox">
    <!-- Tells Google not to provide a translation for this page -->
    <meta name="google" content="notranslate">

    <title><%= page_title(@conn) %></title>
    
    <meta name="apple-mobile-web-app-title" content="WorldSwingDJs">

    <link rel="icon" type="image/png" sizes="16x16" href="https://res.cloudinary.com/don2kwaju/image/upload/c_scale,w_16/fl_immutable_cache/v1503520190/wsdjs/worldswingdjs_single_flat.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://res.cloudinary.com/don2kwaju/image/upload/c_scale,w_32/fl_immutable_cache/v1503520190/wsdjs/worldswingdjs_single_flat.png">
    <link rel="icon" type="image/png" sizes="96x96" href="https://res.cloudinary.com/don2kwaju/image/upload/c_scale,w_96/fl_immutable_cache/v1503520190/wsdjs/worldswingdjs_single_flat.png">

    <link rel="apple-touch-icon" href="https://res.cloudinary.com/don2kwaju/image/upload/b_rgb:ffffff,c_fit,w_80/v1503520190/wsdjs/worldswingdjs_single_flat.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://res.cloudinary.com/don2kwaju/image/upload/b_rgb:ffffff,c_fit,w_152/v1503520190/wsdjs/worldswingdjs_single_flat.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://res.cloudinary.com/don2kwaju/image/upload/b_rgb:ffffff,c_fit,w_180/v1503520190/wsdjs/worldswingdjs_single_flat.png">
    <link rel="apple-touch-icon" sizes="167x167" href="https://res.cloudinary.com/don2kwaju/image/upload/b_rgb:ffffff,c_fit,w_167/v1503520190/wsdjs/worldswingdjs_single_flat.png">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <link href="https://res.cloudinary.com/don2kwaju/image/upload/b_rgb:1f2532,c_scale,h_2732,w_2048/v1538673297/wsdjs/wsdjs.png" sizes="2048x2732" rel="apple-touch-startup-image" />
    <link href="https://res.cloudinary.com/don2kwaju/image/upload/b_rgb:1f2532,c_scale,h_2224,w_1668/v1538673297/wsdjs/wsdjs.png" sizes="1668x2224" rel="apple-touch-startup-image" />
    <link href="https://res.cloudinary.com/don2kwaju/image/upload/b_rgb:1f2532,c_scale,h_2048,w_1536/v1538673297/wsdjs/wsdjs.png" sizes="1536x2048" rel="apple-touch-startup-image" />
    <link href="https://res.cloudinary.com/don2kwaju/image/upload/b_rgb:1f2532,c_scale,h_2436,w_1125/v1538673297/wsdjs/wsdjs.png" sizes="1125x2436" rel="apple-touch-startup-image" />
    <link href="https://res.cloudinary.com/don2kwaju/image/upload/b_rgb:1f2532,c_scale,h_2208,w_1242/v1538673297/wsdjs/wsdjs.png" sizes="1242x2208" rel="apple-touch-startup-image" />
    <link href="https://res.cloudinary.com/don2kwaju/image/upload/b_rgb:1f2532,c_scale,h_1334,w_750/v1538673297/wsdjs/wsdjs.png" sizes="750x1334" rel="apple-touch-startup-image" />
    <link href="https://res.cloudinary.com/don2kwaju/image/upload/b_rgb:1f2532,c_scale,h_1136,w_640/v1538673297/wsdjs/wsdjs.png" sizes="640x1136" rel="apple-touch-startup-image" />

    <link rel="manifest" href="<%= Routes.static_path(@conn, "/manifest.webmanifest") %>">

    <link defer rel="stylesheet" type="text/css" href="<%= Routes.static_path(@conn, "/css/app.css") %>">
    <script defer src="https://cdn.polyfill.io/v2/polyfill.js?features=IntersectionObserver,fetch,Promise,IntersectionObserverEntry&flags=gated"></script>

    <script defer src="<%= Routes.static_path(@conn, "/js/app.js") %>"></script>
    <script defer src="https://widget.cloudinary.com/global/all.js" type="text/javascript"></script>
    <%= if user = @conn.assigns[:current_user] do %>
    <script>window.userToken = "<%= Phoenix.Token.sign(@conn, "user", user.id) %>"</script>
    <%= tag :meta, name: "channel_token", content: Phoenix.Token.sign(@conn, "user", user.id) %>
    <% end %>
    <script>window.baseApiUrl = "<%= ApiRoutes.base_path() %>"</script>
    <%= render_existing(@view_module, "_meta." <> @view_template, assigns) %>
  </head>

  <body class="font-sans">
    <nav class="glnav md:px-4">
      <div class="container flex flex-wrap items-end">
        <%= link "Discover", to: Routes.home_path(@conn, :index), class: "h1" %>

        <%= link "Chart", to: Routes.top_path(@conn, :index), class: "glnav__menu visible-link" %>
        <%= link "Library", to: Routes.song_path(@conn, :index), class: "glnav__menu visible-link" %>
        <%= if Wsdjs.Accounts.Users.can?(@conn.assigns.current_user, :index) == :ok do %>
        <%= link "Members", to: Routes.user_path(@conn, :index), class: "glnav__menu visible-link" %>
        <% end %>
        <%= if Wsdjs.Happenings.can?(@conn.assigns.current_user, :index) == :ok do %>
        <%= link "Events", to: Routes.event_path(@conn, :index), class: "glnav__menu visible-link" %>
        <% end %>

        <%= if @current_user do %>
          <%= link to: Routes.user_path(@conn, :show, @current_user.id), class: "glnav__user" do %>
            <img class="glnav__user__avatar" src="<%= Attachments.avatar_url(@current_user.avatar, 40) %>" srcset="<%= Attachments.avatar_srcset(@current_user.avatar, 50) %>" sizes="50px">
          <% end %>
        <% end %>
      </div>
    </nav>

    <main class="<%= js_view_name(@conn, @view_template) %> flex flex-col justify-between pb-32"
          data-js-view-name="<%= js_view_name(@conn, @view_template) %>"
          data-user-id="<%= current_user_id(@current_user) %>">
      <%= render @view_module, @view_template, assigns %>
    </main>
    
    <%= render "_radio_player.html", conn: @conn %>
    <%= render "_video_player.html", conn: @conn %>
    <%= render "_mobile_nav.html", conn: @conn %>

    <%= render "_desktop-outside.html", conn: @conn, current_user: @current_user %>
  </body>
</html>
